# PointNet: 3D Object Classification on ModelNet10python -m venv labs

### 1. Создание виртуального окружения

```bash
# Создание виртуального окружения
python -m venv labs

# Активация (выберите соответствующую команду для вашей ОС)
labs\Scripts\activate  # Windows

source labs/bin/activate  # Linux/MacOS
```
  
### 2. Установка зависимостей

```bash
pip install -r requirements.txt
```
### 3. Подготовка данных

Убедитесь, что:
Распакованный ModelNet10 лежит в ../ModelNet10/
Запустите препроцессинг:
```bash
cd lab5
python data.py
```
### 4. Обучение модели
```bash
python train.py
```


### 1. Какие категории объектов классифицируются хуже всего и почему?
На основе матрицы ошибок (confusion matrix) можно выделить **наиболее проблемные пары классов**, где модель чаще путает объекты:
- **`chair` ↔ `sofa`**  
    → Схожая форма, наличие сидений, подлокотников, часто одинаковое соотношение размеров.
- **`table` ↔ `desk`**  
    → Оба имеют плоскую поверхность и ножки; различия в деталях (например, ящики у desk) не всегда хорошо захватываются при случайном сэмплировании 1024 точек.
- **`night_stand` ↔ `dresser`**  
    → Оба — мебель для хранения; отличаются масштабом, но при нормализации в [-1,1] масштаб теряется.
    
Это может быть связано с тем, что: 
- PointNet работает с **облаками точек без структуры сетки** — он не видит "границы" или "плоскости", а только распределение точек.
- При случайном сэмплировании **некоторые ключевые детали могут быть пропущены** (например, спинка стула или ящик стола).
- Модель **не использует аугментацию** (повороты, шум), что снижает обобщающую способность.
### 2. Влияет ли количество точек (512, 1024, 2048) на качество модели?

Количество точек напрямую влияет на качество модели:
- **Мало точек (512)** → недостаточно информации о форме → **низкая точность** (например, ~80–83%)
- **1024 точки** → оптимальный баланс между качеством и вычислительной сложностью → **наша модель достигла 88.11%**
- **Больше точек (2048+)** → потенциально более высокая точность, но:
    - Увеличивается время обучения
    - Требуется больше памяти
    - Может привести к переобучению, если данные не аугментированы
    - В оригинальной статье Qi et al. показали, что **1024 точки — это «золотая середина»** для ModelNet.


Вывод: **1024 точки — оптимальны** для ModelNet10: обеспечивают высокую точность при разумных вычислительных затратах.
### 3. Какие преимущества PointNet по сравнению с CNN для 3D данных?
PointNet предлагает ключевые преимущества перед традиционными CNN, которые работают с 2D изображениями или вокселями:

| Критерий | PointNet | CNN (на вокселях/изображениях) |
|----------|----------|--------------------------------|
| **Входные данные** | Облака точек (неупорядоченные, произвольное число) | Воксели (фиксированный объём) или проекции (2D изображения) |
| **Инвариантность** | Абсолютно инвариантен к перестановке точек (благодаря max pooling) | Не инвариантен — требует предобработки (например, повороты) |
| **Вычислительная сложность** | Линейная от числа точек | Кубическая от размера вокселя (например, 32³ = 32768) |
| **Память** | Низкая — хранит только координаты точек | Высокая — требует 3D-сетку (воксели) |
| **Геометрическая интерпретация** | Работает напрямую с 3D-геометрией | Теряет 3D-структуру при проекции в 2D |
**Ключевые преимущества PointNet:**

- **Работает с сырыми облаками точек** — не требует преобразования в воксели или изображения.
- **Инвариантен к порядку точек** — это критично, так как облака точек неупорядочены.
- **Эффективен по памяти и вычислениям** — подходит для реального времени.
- **Содержит T-Nets** — автоматически выравнивает входные данные, делая модель инвариантной к поворотам и масштабу.